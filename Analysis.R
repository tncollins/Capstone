library("readxl")
library("dplyr")

file<-"C:/Users/karat/Documents/Capstone/BMIInfo.xlsx"
multiples <- c("OAS30001",
               "OAS30002",
               "OAS30003",
               "OAS30004",
               "OAS30005",
               "OAS30006",
               "OAS30007",
               "OAS30008",
               "OAS30009",
               "OAS30011",
               "OAS30014",
               "OAS30015",
               "OAS30018",
              "OAS30025",
              "OAS30026",
              "OAS30027",
              "OAS30028",
              "OAS30029",
              "OAS30032",
              "OAS30033",
              "OAS30035",
              "OAS30038",
              "OAS30040",
              "OAS30044",
              "OAS30046",
              "OAS30048",
              "OAS30049",
              "OAS30050",
              "OAS30051",
              "OAS30052",
              "OAS30058",
              "OAS30062",
              "OAS30065",
              "OAS30066",
              "OAS30071",
              "OAS30072",
              "OAS30073",
              "OAS30074",
              "OAS30075",
              "OAS30076",
              "OAS30079",
              "OAS30080",
              "OAS30083",
              "OAS30084",
              "OAS30090",
              "OAS30093",
              "OAS30097",
              "OAS30101",
              "OAS30107",
              "OAS30108",
              "OAS30109",
              "OAS30112",
              "OAS30113",
              "OAS30117",
              "OAS30119",
              "OAS30126",
              "OAS30127",
              "OAS30132",
              "OAS30134",
              "OAS30135",
              "OAS30137",
              "OAS30139",
              "OAS30141",
              "OAS30142",
              "OAS30143",
              "OAS30145",
              "OAS30146",
              "OAS30149",
              "OAS30160",
              "OAS30161",
              "OAS30164",
              "OAS30165",
              "OAS30167",
              "OAS30168",
              "OAS30173",
              "OAS30175",
              "OAS30178",
              "OAS30182",
              "OAS30184",
              "OAS30185",
              "OAS30188",
              "OAS30191",
              "OAS30193",
              "OAS30194",
              "OAS30204",
              "OAS30206",
              "OAS30208",
              "OAS30209",
              "OAS30211",
              "OAS30212",
              "OAS30218",
              "OAS30219",
              "OAS30220",
              "OAS30221",
              "OAS30223",
              "OAS30231",
              "OAS30232",
              "OAS30233",
              "OAS30237",
              "OAS30240",
              "OAS30241",
              "OAS30244",
              "OAS30246",
              "OAS30247",
              "OAS30248",
              "OAS30249",
              "OAS30250",
              "OAS30251",
              "OAS30253",
              "OAS30256",
              "OAS30257",
              "OAS30258",
              "OAS30261",
              "OAS30262",
              "OAS30263",
              "OAS30272",
              "OAS30273",
              "OAS30274",
              "OAS30275",
              "OAS30276",
              "OAS30280",
              "OAS30283",
              "OAS30284",
              "OAS30291",
              "OAS30293",
              "OAS30295",
              "OAS30302",
              "OAS30303",
              "OAS30306",
              "OAS30307",
              "OAS30308",
              "OAS30314",
              "OAS30318",
              "OAS30320",
              "OAS30321",
              "OAS30322",
              "OAS30324",
              "OAS30328",
              "OAS30331",
              "OAS30333",
              "OAS30334",
              "OAS30335",
              "OAS30336",
              "OAS30342",
              "OAS30343",
              "OAS30344",
              "OAS30346",
              "OAS30349",
              "OAS30350",
              "OAS30353",
              "OAS30355",
              "OAS30357",
              "OAS30361",
              "OAS30363",
              "OAS30367",
              "OAS30368",
              "OAS30369",
              "OAS30371",
              "OAS30372",
              "OAS30373",
              "OAS30375",
              "OAS30382",
              "OAS30387",
              "OAS30390",
              "OAS30391",
              "OAS30392",
              "OAS30393",
              "OAS30395",
              "OAS30399",
              "OAS30402",
              "OAS30403",
              "OAS30405",
              "OAS30407",
              "OAS30411",
              "OAS30413",
              "OAS30414",
              "OAS30417",
              "OAS30418",
              "OAS30419",
              "OAS30423",
              "OAS30430",
              "OAS30438",
              "OAS30443",
              "OAS30449",
              "OAS30452",
              "OAS30455",
              "OAS30458",
              "OAS30462",
              "OAS30464",
              "OAS30466",
              "OAS30470",
              "OAS30471",
              "OAS30472",
              "OAS30473",
              "OAS30476",
              "OAS30478",
              "OAS30479",
              "OAS30480",
              "OAS30483",
              "OAS30484",
              "OAS30486",
              "OAS30487",
              "OAS30490",
              "OAS30492",
              "OAS30496",
              "OAS30499",
              "OAS30500",
              "OAS30502",
              "OAS30507",
              "OAS30514",
              "OAS30516",
              "OAS30521",
              "OAS30525",
              "OAS30531",
              "OAS30534",
              "OAS30535",
              "OAS30537",
              "OAS30541",
              "OAS30542",
              "OAS30551",
              "OAS30552",
              "OAS30553",
              "OAS30557",
              "OAS30558",
              "OAS30559",
              "OAS30560",
              "OAS30562",
              "OAS30564",
              "OAS30568",
              "OAS30571",
              "OAS30572",
              "OAS30574",
              "OAS30579",
              "OAS30580",
              "OAS30581",
              "OAS30586",
              "OAS30588",
              "OAS30589",
              "OAS30590",
              "OAS30591",
              "OAS30595",
              "OAS30596",
              "OAS30597",
              "OAS30600",
              "OAS30601",
              "OAS30603",
              "OAS30605",
              "OAS30608",
              "OAS30612",
              "OAS30614",
              "OAS30615",
              "OAS30620",
              "OAS30622",
              "OAS30624",
              "OAS30625",
              "OAS30632",
              "OAS30633",
              "OAS30635",
              "OAS30638",
              "OAS30642",
              "OAS30643",
              "OAS30647",
              "OAS30651",
              "OAS30652",
              "OAS30656",
              "OAS30659",
              "OAS30660",
              "OAS30664",
              "OAS30667",
              "OAS30668",
              "OAS30671",
              "OAS30672",
              "OAS30673",
              "OAS30674",
              "OAS30675",
              "OAS30676",
              "OAS30681",
              "OAS30683",
              "OAS30685",
              "OAS30687",
              "OAS30688",
              "OAS30699",
              "OAS30701",
              "OAS30703",
              "OAS30709",
              "OAS30710",
              "OAS30711",
              "OAS30713",
              "OAS30715",
              "OAS30717",
              "OAS30720",
              "OAS30722",
              "OAS30723",
              "OAS30725",
              "OAS30727",
              "OAS30729",
              "OAS30731",
              "OAS30733",
              "OAS30734",
              "OAS30735",
              "OAS30737",
              "OAS30742",
              "OAS30743",
              "OAS30744",
              "OAS30745",
              "OAS30747",
              "OAS30748",
              "OAS30749",
              "OAS30750",
              "OAS30755",
              "OAS30756",
              "OAS30762",
              "OAS30765",
              "OAS30767",
              "OAS30768",
              "OAS30769",
              "OAS30770",
              "OAS30775",
              "OAS30776",
              "OAS30777",
              "OAS30778",
              "OAS30780",
              "OAS30781",
              "OAS30782",
              "OAS30786",
              "OAS30788",
              "OAS30789",
              "OAS30792",
              "OAS30794",
              "OAS30797",
              "OAS30803",
              "OAS30804",
              "OAS30805",
              "OAS30808",
              "OAS30810",
              "OAS30814",
              "OAS30816",
              "OAS30817",
              "OAS30818",
              "OAS30819",
              "OAS30821",
              "OAS30822",
              "OAS30823",
              "OAS30825",
              "OAS30827",
              "OAS30829",
              "OAS30830",
              "OAS30832",
              "OAS30835",
              "OAS30841",
              "OAS30845",
              "OAS30852",
              "OAS30854",
              "OAS30857",
              "OAS30858",
              "OAS30861",
              "OAS30863",
              "OAS30866",
              "OAS30867",
              "OAS30869",
              "OAS30870",
              "OAS30871",
              "OAS30872",
              "OAS30875",
              "OAS30876",
              "OAS30880",
              "OAS30881",
              "OAS30883",
              "OAS30884",
              "OAS30887",
              "OAS30896",
              "OAS30898",
              "OAS30899",
              "OAS30904",
              "OAS30905",
              "OAS30907",
              "OAS30908",
              "OAS30910",
              "OAS30913",
              "OAS30919",
              "OAS30920",
              "OAS30921",
              "OAS30926",
              "OAS30928",
              "OAS30929",
              "OAS30930",
              "OAS30933",
              "OAS30934",
              "OAS30936",
              "OAS30938",
              "OAS30939",
              "OAS30942",
              "OAS30949",
              "OAS30956",
              "OAS30959",
              "OAS30960",
              "OAS30963",
              "OAS30964",
              "OAS30966",
              "OAS30967",
              "OAS30978",
              "OAS30979",
              "OAS30981",
              "OAS30982",
              "OAS30986",
              "OAS30989",
              "OAS30990",
              "OAS30992",
              "OAS30993",
              "OAS30997",
              "OAS31001",
              "OAS31002",
              "OAS31005",
              "OAS31006",
              "OAS31009",
              "OAS31012",
              "OAS31013",
              "OAS31014",
              "OAS31018",
              "OAS31019",
              "OAS31020",
              "OAS31021",
              "OAS31023",
              "OAS31024",
              "OAS31025",
              "OAS31028",
              "OAS31031",
              "OAS31032",
              "OAS31037",
              "OAS31039",
              "OAS31041",
              "OAS31043",
              "OAS31045",
              "OAS31046",
              "OAS31047",
              "OAS31048",
              "OAS31054",
              "OAS31056",
              "OAS31058",
              "OAS31059",
              "OAS31063",
              "OAS31064",
              "OAS31065",
              "OAS31068",
              "OAS31072",
              "OAS31073",
              "OAS31077",
              "OAS31078",
              "OAS31081",
              "OAS31083",
              "OAS31084",
              "OAS31085",
              "OAS31087",
              "OAS31088",
              "OAS31090",
              "OAS31092",
              "OAS31094",
              "OAS31099",
              "OAS31103",
              "OAS31104",
              "OAS31105",
              "OAS31108",
              "OAS31110",
              "OAS31111",
              "OAS31113",
              "OAS31114",
              "OAS31118",
              "OAS31119",
              "OAS31125",
              "OAS31127",
              "OAS31128",
              "OAS31132",
              "OAS31138",
              "OAS31139",
              "OAS31142",
              "OAS31150",
              "OAS31153",
              "OAS31155",
              "OAS31157",
              "OAS31158",
              "OAS31159",
              "OAS31161",
               "OAS31164",
               "OAS31165",
               "OAS31167",
               "OAS31168",
              "OAS31172")

#Scans already done
done<-c("OAS30001",
        "OAS30002",
        "OAS30003",
        "OAS30004",
        "OAS30005",
        "OAS30006",
        "OAS30007",
        "OAS30008",
        "OAS30025",
        "OAS30026",
        "OAS30028",
        "OAS30044",
        "OAS30046",
        "OAS30048",
        "OAS30050",
        "OAS30052",
        "OAS30065",
        "OAS30066",
        "OAS30071",
        "OAS30073",
        "OAS30075",
        "OAS30080",
        "OAS30083",
        "OAS30093",
        "OAS30097",
        "OAS30108",
        "OAS30109",
        "OAS30112",
        "OAS30113",
        "OAS30117",
        "OAS30126",
        "OAS30127",
        "OAS30134",
        "OAS30135",
        "OAS30139",
        "OAS30143",
        "OAS30146",
        "OAS30149",
        "OAS30178",
        "OAS30182",
        "OAS30184",
        "OAS30185",
        "OAS30194",
        "OAS30204",
        "OAS30206",
        "OAS30219",
        "OAS30220",
        "OAS30221",
        "OAS30233",
        "OAS30240",
        "OAS30248",
        "OAS30249",
        "OAS30250",
        "OAS30272",
        "OAS30274",
        "OAS30276",
        "OAS30291",
        "OAS30293",
        "OAS30306",
        "OAS30307",
        "OAS30318",
        "OAS30320",
        "OAS30324",
        "OAS30328",
        "OAS30333",
        "OAS30335",
        "OAS30336",
        "OAS30346",
        "OAS30349",
        "OAS30350",
        "OAS30361",
        "OAS30367",
        "OAS30368",
        "OAS30369",
        "OAS30371",
        "OAS30372",
        "OAS30382",
        "OAS30387",
        "OAS30392",
        "OAS30395",
        "OAS30402",
        "OAS30403",
        "OAS30407",
        "OAS30411",
        "OAS30414",
        "OAS30417",
        "OAS30423",
        "OAS30438",
        "OAS30455",
        "OAS30458",
        "OAS30462",
        "OAS30476",
        "OAS30479",
        "OAS30483",
        "OAS30484",
        "OAS30486",
        "OAS30492",
        "OAS30516",
        "OAS30531",
        "OAS30534",
        "OAS30535",
        "OAS30537",
        "OAS30551",
        "OAS30558",
        "OAS30562",
        "OAS30568",
        "OAS30572",
        "OAS30574",
        "OAS30579",
        "OAS30580",
        "OAS30586",
        "OAS30589",
        "OAS30590",
        "OAS30597",
        "OAS30601",
        "OAS30603",
        "OAS30608",
        "OAS30620",
        "OAS30632",
        "OAS30638",
        "OAS30643",
        "OAS30659",
        "OAS30664",
        "OAS30667",
        "OAS30671",
        "OAS30673",
        "OAS30676",
        "OAS30681",
        "OAS30683",
        "OAS30685",
        "OAS30711",
        "OAS30715",
        "OAS30722",
        "OAS30723",
        "OAS30725",
        "OAS30729",
        "OAS30733",
        "OAS30735",
        "OAS30742",
        "OAS30748",
        "OAS30750",
        "OAS30756",
        "OAS30767",
        "OAS30768",
        "OAS30769",
        "OAS30770",
        "OAS30775",
        "OAS30776",
        "OAS30777",
        "OAS30788",
        "OAS30794",
        "OAS30803",
        "OAS30808",
        "OAS30810",
        "OAS30818",
        "OAS30819",
        "OAS30821",
        "OAS30823",
        "OAS30832",
        "OAS30841",
        "OAS30845",
        "OAS30852",
        "OAS30857",
        "OAS30858",
        "OAS30861",
        "OAS30867",
        "OAS30875",
        "OAS30881",
        "OAS30887",
        "OAS30896",
        "OAS30905",
        "OAS30907",
        "OAS30910",
        "OAS30913",
        "OAS30921",
        "OAS30938",
        "OAS30939",
        "OAS30959",
        "OAS30960",
        "OAS30966",
        "OAS30978",
        "OAS30979",
        "OAS30981",
        "OAS30982",
        "OAS30993",
        "OAS30997",
        "OAS31005",
        "OAS31012",
        "OAS31013",
        "OAS31014",
        "OAS31018",
        "OAS31019",
        "OAS31020",
        "OAS31021",
        "OAS31023",
        "OAS31028",
        "OAS31031",
        "OAS31039",
        "OAS31041",
        "OAS31048",
        "OAS31056",
        "OAS31064",
        "OAS31068",
        "OAS31072",
        "OAS31087",
        "OAS31088",
        "OAS31090",
        "OAS31110",
        "OAS31111",
        "OAS31113",
        "OAS31114",
        "OAS31118",
        "OAS31119",
        "OAS31125",
        "OAS31127",
        "OAS31150",
        "OAS31153",
        "OAS31158",
        "OAS31161",
        "OAS31165",
        "OAS31167")
data<- read_excel(file,col_names=TRUE)
data %>%
  select(Subject) %>%
  filter(Subject %in% multiples)
filtered <- data %>%select(Subject) %>% filter(Subject %in% multiples)
need <- filtered %>%select(Subject) %>% filter(!Subject %in% done)
print(need,n=470)
dim(need)
# head(data,5)
# underWeightMMSE <- 0
# healthyMMSE <- 0
#"OverweightMMSE <- 0
#"ObeseMMSE <- 0
# for(i in 1:938){
# 	if(identical(as.numeric(data[i,"Underweight"]),1)){
# 		 underWeightMMSE = underWeightMMSE+as.numeric(data[i,"ChangeinMMSE"])
# 	}
# }
# avg = underWeightMMSE/12
# str(underWeightMMSE)
# str(avg)
# 
# #healthy
# for(i in 1:938){
# 	if(identical(as.numeric(data[i,"Healthy"]),1)){
# 		 healthyMMSE = healthyMMSE+as.numeric(data[i,"ChangeinMMSE"])
# 	}
# }
# avg = healthyMMSE/301
# str(healthyMMSE)
# str(avg)
# 
# #overweight
# for(i in 1:938){
# 	if(identical(as.numeric(data[i,"overweight"]),1)){
# 		OverweightMMSE =OverweightMMSE+as.numeric(data[i,"ChangeinMMSE"])
# 	}
# }
# avg ="OverweightMMSE/381
# str(overweightMMSE)
# str(avg)
# 
# for(i in 1:938){
# 	if(identical(as.numeric(data[i,"Obese"]),1)){
# 		ObeseMMSE =ObeseMMSE+as.numeric(data[i,"ChangeinMMSE"])
# 	}
# }
# avg = ObeseMMSE/244
# str(obeseMMSE)
# str(avg)